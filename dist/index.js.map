{"version":3,"file":"index.js","sources":["../src/init/extend.js","../src/init/mixin.js","../src/lib/typeof.js","../src/init/watch.js","../src/init/bindEvents.js","../src/init/index.js","../src/events.js","../src/setter.js","../src/getter.js","../src/selector.js","../src/lib/shim/array.js","../src/lib/shim/index.js","../src/index.js"],"sourcesContent":["export default function (defaultOptions = {}, options = {}) {\n  return $.extend(true, {\n    tagName: 'div',\n    data: {},\n    events: {},\n    methods: {},\n    watch: {},\n    beforeInit() {},\n    init() {},\n    inited() {}\n  }, defaultOptions, options)\n}","export default function (methods) {\n  Object.assign(this, methods)\n}","const toString = Object.prototype.toString\n\nfunction type(val) {\n  return toString.call(val)\n}\n\nexport function isArray(val) {\n  return type(val) === '[object Array]'\n}\n\nexport function isObject(val) {\n  return type(val) === '[object Object]'\n}\n\nexport function isFunction(val) {\n  return type(val) === '[object Function]'\n}\n\nexport function isNumber(val) {\n  return type(val) === '[object Number]'\n}\n\nexport function isString(val) {\n  return type(val) === '[object String]'\n}\n\nexport function isBoolean(val) {\n  return type(val) === '[object Boolean]'\n}","import {\n  isFunction\n} from '../lib/typeof'\n\nexport default function handler(watch) {\n  for (let name in watch) {\n    if (isFunction(watch[name])) {\n      this.on(name, watch[name])\n    } else {\n      let watchs = watch[name]\n      let i = 0;\n      let len = watchs.length\n      let options = {}\n      for (; i < len; i++) {\n        options[name] = watchs[i]\n        handler.call(this, options)\n      }\n    }\n  }\n}","import {\n  isFunction\n} from '../lib/typeof'\n\nexport default function (events) {\n\n  function bindEvent(...args) {\n    let handler = args.pop()\n    if (isFunction(handler)) {\n      handler = [handler]\n    } else {\n      handler = handler.split(' ')\n    }\n    for (let i = 0, len = handler.length; i < len; i++) {\n      let callback = handler[i]\n      if (!isFunction(callback)) {\n        callback = this[callback]\n      }\n      this.$el.on.apply(this.$el, args.concat((event) => callback.call(this, event)))\n    }\n  }\n\n  for (let type in events) {\n    bindEvent.apply(this, type.split('->').concat(events[type]))\n  }\n}","import extend from './extend'\nimport initMixin from './mixin'\nimport initWatch from './watch'\nimport initBindEvents from './bindEvents'\n\nlet uid = 0\n\nexport default function (Vir) {\n  Vir.prototype._init = function (defaultOptions, options) {\n    let {\n      el,\n      tagName,\n      data,\n      events,\n      methods,\n      watch,\n      beforeInit,\n      init,\n      inited\n    } = extend(defaultOptions, options)\n\n    this._uid = ++uid\n    this.$el = el ? $(el) : $('<' + tagName + '>')\n    this.data = data\n    this._events = {}\n    this._cache = {}\n\n    beforeInit.call(this)\n    initMixin.call(this, methods)\n    initWatch.call(this, watch)\n    initBindEvents.call(this, events)\n    init.call(this)\n    inited.call(this)\n  }\n}","export default function (Vir) {\n\n  function all(type) {\n    if (type === void 0) {\n      return this._events\n    }\n    let t = type.toLowerCase()\n    return this._events[t] || (this._events[t] = [])\n  }\n\n  Vir.prototype.getEventListeners = all\n\n  Vir.prototype.on = function (type, handler) {\n    // todo 过滤重复绑定问题\n    all.call(this, type).push(handler)\n    return () => {\n      this.off(type, handler)\n    }\n  }\n\n  Vir.prototype.once = function (type, handler) {\n    handler._once = true\n    this.on(type, handler)\n  }\n\n  Vir.prototype.off = function (type, handler) {\n    let queue = all.call(this, type)\n    if (handler == void 0) {\n      queue.length = 0\n      return\n    }\n\n    let i = queue.indexOf(handler)\n\n    if (~i) {\n      queue.splice(i, 1)\n    }\n\n  }\n\n  Vir.prototype.emit = function (type, args, ctx) {\n    let queue = all.call(this, type)\n    if (type != '*') {\n      queue = queue.concat(all.call(this, '*'))\n    }\n\n    queue.forEach((handler) => {\n      handler.call(ctx, args)\n      if (handler._once) {\n        this.off(type, handler)\n      }\n    })\n\n  }\n}","import {\n  isObject\n} from './lib/typeof'\n\nexport default function (Vir) {\n  Vir.prototype.set = function (name, value, options = {}) {\n    if (isObject(name)) {\n      for (let i in name) {\n        this.set(i, name[i], value)\n      }\n    } else {\n\n      let old = this.get(name)\n\n      this.data[name] = value\n\n      if (!options.force && old === value) {\n        return\n      }\n\n      if (options.silent) {\n        return\n      }\n\n      this.emit(name, {\n        old: old,\n        value: value,\n        type: name\n      }, this)\n    }\n  }\n}","export default function (Vir) {\n  Vir.prototype.get = function (name) {\n    return this.data[name]\n  }\n}","export default function (Vir) {\n  Vir.prototype.$$ = function (selector, cache) {\n\n    let _cache = this._cache\n\n    let _selector = selector.replace(/\\s/g, '')\n\n    if (cache === false) {\n      _cache[_selector] = null\n    }\n\n    let $el = _cache[_selector]\n    if ($el) {\n      return $el\n    }\n    $el = this.$el.find(selector)\n    _cache[_selector] = $el\n    return $el\n  }\n}","export function forEach(callback) {\n  for (let i = 0, len = this.length; i < len; i++) {\n    callback(this[i], i, this)\n  }\n}\n\nexport function indexOf(value, i = 0) {\n  let len = this.length\n  i = Math.max(i >= 0 ? i : len - Math.abs(i), 0)\n  for (; i < len; i++) {\n    if (this[i] === value) {\n      return i\n    }\n  }\n  return -1\n}","import * as array from './array'\n\nexport function forEach() {\n  if (!Array.prototype.forEach) {\n    Array.prototype.forEach = array.forEach\n  }\n}\n\nexport function indexOf() {\n  if (!Array.prototype.indexOf) {\n    Array.prototype.indexOf = array.indexOf\n  }\n}","import init from './init/index'\nimport initEvents from './events'\nimport initSetter from './setter'\nimport initGetter from './getter'\nimport initSelector from './selector'\n\nimport * as shim from './lib/shim/index'\n\nshim.forEach()\nshim.indexOf()\n\nexport default function (defaultOptions) {\n  function Vir(options) {\n    if (!this instanceof Vir) {\n      return new Vir(options)\n    }\n\n    this._init(defaultOptions, options)\n  }\n\n  init(Vir)\n  initEvents(Vir)\n  initSetter(Vir)\n  initGetter(Vir)\n  initSelector(Vir)\n\n  return Vir\n}"],"names":["defaultOptions","options","$","extend","methods","toString","Object","prototype","type","val","call","isObject","isFunction","handler","watch","name","on","watchs","i","len","length","events","bindEvent","args","pop","split","callback","$el","apply","concat","event","uid","Vir","_init","el","tagName","data","beforeInit","init","inited","_uid","_events","_cache","all","t","toLowerCase","getEventListeners","push","off","once","_once","queue","indexOf","splice","emit","ctx","forEach","set","value","old","get","force","silent","$$","selector","cache","_selector","replace","find","Math","max","abs","Array","array","shim"],"mappings":"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"}