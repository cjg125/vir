{"version":3,"file":"index.js","sources":["../src/lib/object.js","../src/lib/typeof.js","../src/lib/assign.js","../src/init/mixins.js","../src/init/methods.js","../src/lib/array.js","../src/init/watch.js","../src/init/bindEvents.js","../src/init/index.js","../src/eventEmiter.js","../src/setter.js","../src/getter.js","../src/selector.js","../src/index.js"],"sourcesContent":["export const create = Object.create || function (target) {\n  let TEMP = function () {}\n  TEMP.prototype = target\n  let temp = new TEMP\n  TEMP.prototype = null\n  return temp\n}","const toString = Object.prototype.toString\n\nfunction type(val) {\n  return toString.call(val)\n}\n\nexport function isArray(val) {\n  return type(val) === '[object Array]'\n}\n\nexport function isObject(val) {\n  return type(val) === '[object Object]'\n}\n\nexport function isFunction(val) {\n  return type(val) === '[object Function]'\n}\n\nexport function isNumber(val) {\n  return type(val) === '[object Number]'\n}\n\nexport function isString(val) {\n  return type(val) === '[object String]'\n}\n\nexport function isBoolean(val) {\n  return type(val) === '[object Boolean]'\n}","import {\n  isObject,\n  isArray,\n  isBoolean\n} from './typeof'\n\nexport default function assign(...args) {\n  let target = args[0]\n  let i = 1\n  let deep = false\n\n  if (isBoolean(target)) {\n    deep = target\n    target = args[1]\n    i = 2\n  }\n\n  for (let source; source = args[i++];) {\n    if (isObject(source) || isArray(source)) {\n      for (let key in source) {\n        let _target = target[key]\n        let _source = source[key]\n        if (deep && isObject(_target) && isObject(_source)) {\n          target[key] = assign(deep, {}, _target, _source)\n        } else if (deep && isArray(_target) && isArray(_source)) {\n          target[key] = assign(deep, [], _target, _source)\n        } else {\n          target[key] = _source\n        }\n      }\n    }\n  }\n\n  return target\n}","import {\n  create\n} from '../lib/object'\n\nimport assign from '../lib/assign'\n\nexport default function (options = {}) {\n\n  let mixins = options.mixins || []\n\n\n  return assign.apply(null, [true, {\n    tagName: 'div',\n    data: create(null),\n    events: create(null),\n    methods: create(null),\n    watch: create(null),\n    validate: create(null),\n    beforeInit() {},\n    init() {},\n    inited() {}\n  }, options].concat(mixins))\n}","export default function (methods) {\n  Object.assign(this, methods)\n}","export function forEach(array, callback) {\n  for (let i = 0, len = array.length; i < len; i++) {\n    callback(array[i], i, array)\n  }\n}\n\nexport function indexOf(array, value, i = 0) {\n  let len = array.length\n  i = Math.max(i >= 0 ? i : len - Math.abs(i), 0)\n  for (; i < len; i++) {\n    if (array[i] === value) {\n      return i\n    }\n  }\n  return -1\n}","import {\n  isFunction\n} from '../lib/typeof'\n\nimport {\n  forEach\n} from '../lib/array'\n\nexport default function handler(watch) {\n  for (let name in watch) {\n    if (isFunction(watch[name])) {\n      this.on(name, watch[name])\n    } else {\n      forEach(watch[name], (callback) => {\n        handler.call(this, {\n          [name]: callback\n        })\n      })\n    }\n  }\n}","import {\n  isFunction\n} from '../lib/typeof'\n\nimport {\n  forEach\n} from '../lib/array'\n\nexport default function (events) {\n\n  function bindEvent(...args) {\n    let handler = args.pop()\n    if (isFunction(handler)) {\n      handler = [handler]\n    } else {\n      handler = handler.split(' ')\n    }\n\n    forEach(handler, (callback) => {\n      if (!isFunction(callback)) {\n        callback = this[callback]\n      }\n      this.$el.on.apply(this.$el, args.concat((event) => callback.call(this, event)))\n    })\n  }\n\n  for (let type in events) {\n    bindEvent.apply(this, type.split('->').concat(events[type]))\n  }\n}","import $ from 'jquery'\nimport {\n  create\n} from '../lib/object'\nimport initMixins from './mixins'\nimport initMethods from './methods'\nimport initWatch from './watch'\nimport initBindEvents from './bindEvents'\n\nlet uid = 0\n\nexport default function (Vir) {\n  Vir.prototype._init = function (options) {\n    let {\n      el,\n      tagName,\n      data, // object\n      events, // object\n      methods, // object\n      watch, // object\n      validate, // object\n      beforeInit,\n      init,\n      inited\n    } = initMixins(options)\n\n    this._uid = ++uid\n    this.$el = el ? $(el) : $('<' + tagName + '>')\n    this.data = data // state\n    this.validate = validate\n    this._events = create(null) // eventEmiter\n    this._cache = create(null) // selector cache (this.$$)\n\n    beforeInit.call(this)\n    initMethods.call(this, methods)\n    initWatch.call(this, watch)\n    initBindEvents.call(this, events)\n    init.call(this)\n    inited.call(this)\n  }\n}","import {\n  forEach,\n  indexOf\n} from './lib/array'\n\nexport default function (Vir) {\n\n  Vir.prototype.getEventListeners = function (type) {\n    if (type === void 0) {\n      return this._events\n    }\n    let t = type.toLowerCase()\n    return this._events[t] || (this._events[t] = [])\n  }\n\n  Vir.prototype.$watch = function (type, handler, once = false) {\n    handler._once = once\n    return this.on(type, handler)\n  }\n\n  Vir.prototype.on = function (type, handler) {\n    // todo 过滤重复绑定问题\n    this.getEventListeners(type).push(handler)\n    return () => {\n      this.off(type, handler)\n    }\n  }\n\n  Vir.prototype.once = function (type, handler) {\n    handler._once = true\n    this.on(type, handler)\n  }\n\n  Vir.prototype.off = function (type, handler) {\n    let queue = this.getEventListeners(type)\n    if (handler == void 0) {\n      queue.length = 0\n      return\n    }\n\n    let i = indexOf(queue, handler)\n\n    if (~i) {\n      queue.splice(i, 1)\n    }\n\n  }\n\n  Vir.prototype.emit = function (type, args, ctx) {\n    let queue = this.getEventListeners(type)\n    if (type != '*') {\n      queue = queue.concat(this.getEventListeners('*'))\n    }\n\n    forEach(queue, (handler) => {\n      handler.call(ctx, args)\n      if (handler._once) {\n        this.off(type, handler)\n      }\n    })\n\n  }\n}","import {\n  isObject,\n  isFunction\n} from './lib/typeof'\n\nexport default function (Vir) {\n  Vir.prototype.set = function (type, value, options = {}) {\n    if (isObject(type)) {\n      for (let i in type) {\n        this.set(i, type[i], value)\n      }\n    } else {\n\n      let old = this.get(type)\n\n      let args = {\n        old,\n        value,\n        type\n      }\n\n      let validate = this.validate[type]\n\n      if (isFunction(validate) && validate.call(this, args) !== void 0) {\n        return\n      }\n\n      this.data[type] = value\n\n      if (!options.force && old === value) {\n        return\n      }\n\n      if (options.silent) {\n        return\n      }\n\n      this.emit(type, args, this)\n    }\n  }\n}","export default function (Vir) {\n  Vir.prototype.get = function (name) {\n    return this.data[name]\n  }\n}","export default function (Vir) {\n  Vir.prototype.$$ = function (selector, cache) {\n\n    let _cache = this._cache\n\n    let _selector = selector.replace(/\\s/g, '')\n\n    if (cache === false) {\n      _cache[_selector] = null\n    }\n\n    let $el = _cache[_selector]\n    if ($el) {\n      return $el\n    }\n    $el = this.$el.find(selector)\n    _cache[_selector] = $el\n    return $el\n  }\n}","import init from './init/index'\nimport initEventEmitter from './eventEmiter'\nimport initSetter from './setter'\nimport initGetter from './getter'\nimport initSelector from './selector'\n\n\nfunction Vir(options) {\n  if (!(this instanceof Vir)) {\n    return new Vir(options)\n  }\n\n  this._init(options)\n}\n\ninit(Vir)\ninitEventEmitter(Vir)\ninitSetter(Vir)\ninitGetter(Vir)\ninitSelector(Vir)\n\nexport default Vir"],"names":["create","Object","target","TEMP","prototype","temp","toString","type","val","call","isArray","isObject","isFunction","isBoolean","assign","i","deep","source","key","_target","_source","options","mixins","apply","concat","methods","forEach","array","callback","len","length","indexOf","value","Math","max","abs","handler","watch","name","on","events","bindEvent","args","pop","split","$el","event","uid","Vir","_init","initMixins","el","tagName","data","validate","beforeInit","init","inited","_uid","$","_events","_cache","getEventListeners","t","toLowerCase","$watch","once","_once","push","off","queue","splice","emit","ctx","set","old","get","force","silent","$$","selector","cache","_selector","replace","find","initEventEmitter","initSetter","initGetter","initSelector"],"mappings":"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"}