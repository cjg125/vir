{"version":3,"file":"index.js","sources":["../src/lib/objeat.js","../src/init/extend.js","../src/init/mixin.js","../src/lib/typeof.js","../src/lib/array.js","../src/init/watch.js","../src/init/bindEvents.js","../src/init/index.js","../src/events.js","../src/setter.js","../src/getter.js","../src/selector.js","../src/index.js"],"sourcesContent":["export const create = Object.create || function (target) {\n  var TEMP = function () {}\n  TEMP.prototype = null\n  return new TEMP\n}","import {\n  create\n} from '../lib/objeat'\nimport $ from 'jquery'\n\nexport default function (defaultOptions = {}, options = {}) {\n  return $.extend(true, {\n    tagName: 'div',\n    data: create(null),\n    events: create(null),\n    methods: create(null),\n    watch: create(null),\n    validate: create(null),\n    beforeInit() {},\n    init() {},\n    inited() {}\n  }, defaultOptions, options)\n}","export default function (methods) {\n  Object.assign(this, methods)\n}","const toString = Object.prototype.toString\n\nfunction type(val) {\n  return toString.call(val)\n}\n\nexport function isArray(val) {\n  return type(val) === '[object Array]'\n}\n\nexport function isObject(val) {\n  return type(val) === '[object Object]'\n}\n\nexport function isFunction(val) {\n  return type(val) === '[object Function]'\n}\n\nexport function isNumber(val) {\n  return type(val) === '[object Number]'\n}\n\nexport function isString(val) {\n  return type(val) === '[object String]'\n}\n\nexport function isBoolean(val) {\n  return type(val) === '[object Boolean]'\n}","export function forEach(array, callback) {\n  for (let i = 0, len = array.length; i < len; i++) {\n    callback(array[i], i, array)\n  }\n}\n\nexport function indexOf(array, value, i = 0) {\n  let len = array.length\n  i = Math.max(i >= 0 ? i : len - Math.abs(i), 0)\n  for (; i < len; i++) {\n    if (array[i] === value) {\n      return i\n    }\n  }\n  return -1\n}","import {\n  isFunction\n} from '../lib/typeof'\n\nimport {\n  forEach\n} from '../lib/array'\n\nexport default function handler(watch) {\n  for (let name in watch) {\n    if (isFunction(watch[name])) {\n      this.on(name, watch[name])\n    } else {\n      forEach(watch[name], (callback) => {\n        handler.call(this, {\n          [name]: callback\n        })\n      })\n    }\n  }\n}","import {\n  isFunction\n} from '../lib/typeof'\n\nimport {\n  forEach\n} from '../lib/array'\n\nexport default function (events) {\n\n  function bindEvent(...args) {\n    let handler = args.pop()\n    if (isFunction(handler)) {\n      handler = [handler]\n    } else {\n      handler = handler.split(' ')\n    }\n\n    forEach(handler, (callback) => {\n      if (!isFunction(callback)) {\n        callback = this[callback]\n      }\n      this.$el.on.apply(this.$el, args.concat((event) => callback.call(this, event)))\n    })\n  }\n\n  for (let type in events) {\n    bindEvent.apply(this, type.split('->').concat(events[type]))\n  }\n}","import $ from 'jquery'\nimport {\n  create\n} from '../lib/objeat'\nimport extend from './extend'\nimport initMixin from './mixin'\nimport initWatch from './watch'\nimport initBindEvents from './bindEvents'\n\nlet uid = 0\n\nexport default function (Vir) {\n  Vir.prototype._init = function (defaultOptions, options) {\n    let {\n      el,\n      tagName,\n      data,\n      events,\n      methods,\n      watch,\n      validate,\n      beforeInit,\n      init,\n      inited\n    } = extend(defaultOptions, options)\n\n    this._uid = ++uid\n    this.$el = el ? $(el) : $('<' + tagName + '>')\n    this.data = data\n    this.validate = validate\n    this._events = create(null)\n    this._cache = create(null)\n\n    beforeInit.call(this)\n    initMixin.call(this, methods)\n    initWatch.call(this, watch)\n    initBindEvents.call(this, events)\n    init.call(this)\n    inited.call(this)\n  }\n}","import {\n  forEach,\n  indexOf\n} from './lib/array'\n\nexport default function (Vir) {\n\n  Vir.prototype.getEventListeners = function (type) {\n    if (type === void 0) {\n      return this._events\n    }\n    let t = type.toLowerCase()\n    return this._events[t] || (this._events[t] = [])\n  }\n\n  Vir.prototype.$watch = function (type, handler, once = false) {\n    handler._once = once\n    return this.on(type, handler)\n  }\n\n  Vir.prototype.on = function (type, handler) {\n    // todo 过滤重复绑定问题\n    this.getEventListeners(type).push(handler)\n    return () => {\n      this.off(type, handler)\n    }\n  }\n\n  Vir.prototype.once = function (type, handler) {\n    handler._once = true\n    this.on(type, handler)\n  }\n\n  Vir.prototype.off = function (type, handler) {\n    let queue = this.getEventListeners(type)\n    if (handler == void 0) {\n      queue.length = 0\n      return\n    }\n\n    let i = indexOf(queue, handler)\n\n    if (~i) {\n      queue.splice(i, 1)\n    }\n\n  }\n\n  Vir.prototype.emit = function (type, args, ctx) {\n    let queue = this.getEventListeners(type)\n    if (type != '*') {\n      queue = queue.concat(this.getEventListeners('*'))\n    }\n\n    forEach(queue, (handler) => {\n      handler.call(ctx, args)\n      if (handler._once) {\n        this.off(type, handler)\n      }\n    })\n\n  }\n}","import {\n  isObject,\n  isFunction\n} from './lib/typeof'\n\nexport default function (Vir) {\n  Vir.prototype.set = function (type, value, options = {}) {\n    if (isObject(type)) {\n      for (let i in type) {\n        this.set(i, type[i], value)\n      }\n    } else {\n\n      let old = this.get(type)\n\n      let args = {\n        old,\n        value,\n        type\n      }\n\n      let validate = this.validate[type]\n\n      if (isFunction(validate) && validate.call(this, args) !== void 0) {\n        return\n      }\n\n      this.data[type] = value\n\n      if (!options.force && old === value) {\n        return\n      }\n\n      if (options.silent) {\n        return\n      }\n\n      this.emit(type, args, this)\n    }\n  }\n}","export default function (Vir) {\n  Vir.prototype.get = function (name) {\n    return this.data[name]\n  }\n}","export default function (Vir) {\n  Vir.prototype.$$ = function (selector, cache) {\n\n    let _cache = this._cache\n\n    let _selector = selector.replace(/\\s/g, '')\n\n    if (cache === false) {\n      _cache[_selector] = null\n    }\n\n    let $el = _cache[_selector]\n    if ($el) {\n      return $el\n    }\n    $el = this.$el.find(selector)\n    _cache[_selector] = $el\n    return $el\n  }\n}","import init from './init/index'\nimport initEvents from './events'\nimport initSetter from './setter'\nimport initGetter from './getter'\nimport initSelector from './selector'\n\nexport default function (defaultOptions) {\n  function Vir(options) {\n    if (!(this instanceof Vir)) {\n      return new Vir(options)\n    }\n\n    this._init(defaultOptions, options)\n  }\n\n  init(Vir)\n  initEvents(Vir)\n  initSetter(Vir)\n  initGetter(Vir)\n  initSelector(Vir)\n\n  return Vir\n}"],"names":["create","Object","target","TEMP","prototype","defaultOptions","options","$","extend","methods","toString","type","val","call","isObject","isFunction","forEach","array","callback","i","len","length","indexOf","value","Math","max","abs","handler","watch","name","on","events","bindEvent","args","pop","split","$el","apply","concat","event","uid","Vir","_init","el","tagName","data","validate","beforeInit","init","inited","_uid","_events","_cache","getEventListeners","t","toLowerCase","$watch","once","_once","push","off","queue","splice","emit","ctx","set","old","get","force","silent","$$","selector","cache","_selector","replace","find"],"mappings":"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"}