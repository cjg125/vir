{"version":3,"file":"index.min.js","sources":["../src/lib/typeof.js","../src/lib/assign.js","../src/lib/array.js","../src/init/watch.js","../src/index.js","../src/lib/object.js","../src/init/mixins.js","../src/init/methods.js","../src/init/bindEvents.js","../src/init/index.js","../src/eventEmiter.js","../src/setter.js","../src/getter.js","../src/selector.js"],"sourcesContent":["const toString = Object.prototype.toString\n\nfunction type(val) {\n  return toString.call(val)\n}\n\nexport function isArray(val) {\n  return type(val) === '[object Array]'\n}\n\nexport function isObject(val) {\n  return type(val) === '[object Object]'\n}\n\nexport function isFunction(val) {\n  return type(val) === '[object Function]'\n}\n\nexport function isNumber(val) {\n  return type(val) === '[object Number]'\n}\n\nexport function isString(val) {\n  return type(val) === '[object String]'\n}\n\nexport function isBoolean(val) {\n  return type(val) === '[object Boolean]'\n}","import {\n  isObject,\n  isArray,\n  isBoolean\n} from './typeof'\n\nexport default function assign(...args) {\n  let target = args[0]\n  let i = 1\n  let deep = false\n\n  if (isBoolean(target)) {\n    deep = target\n    target = args[1]\n    i = 2\n  }\n\n  for (let source; source = args[i++];) {\n    if (isObject(source) || isArray(source)) {\n      for (let key in source) {\n        let _target = target[key]\n        let _source = source[key]\n        if (deep && isObject(_target) && isObject(_source)) {\n          target[key] = assign(deep, {}, _target, _source)\n        } else if (deep && isArray(_target) && isArray(_source)) {\n          target[key] = assign(deep, [], _target, _source)\n        } else {\n          target[key] = _source\n        }\n      }\n    }\n  }\n\n  return target\n}","export function forEach(array, callback) {\n  for (let i = 0, len = array.length; i < len; i++) {\n    callback(array[i], i, array)\n  }\n}\n\nexport function indexOf(array, value, i = 0) {\n  let len = array.length\n  i = Math.max(i >= 0 ? i : len - Math.abs(i), 0)\n  for (; i < len; i++) {\n    if (array[i] === value) {\n      return i\n    }\n  }\n  return -1\n}","import {\n  isFunction\n} from '../lib/typeof'\n\nimport {\n  forEach\n} from '../lib/array'\n\nexport default function handler(watch) {\n  for (let name in watch) {\n    if (isFunction(watch[name])) {\n      this.on(name, watch[name])\n    } else {\n      forEach(watch[name], (callback) => {\n        handler.call(this, {\n          [name]: callback\n        })\n      })\n    }\n  }\n}","import init from './init/index'\nimport initEventEmitter from './eventEmiter'\nimport initSetter from './setter'\nimport initGetter from './getter'\nimport initSelector from './selector'\n\n\nfunction Vir(options) {\n  if (!(this instanceof Vir)) {\n    return new Vir(options)\n  }\n\n  this._init(options)\n}\n\ninit(Vir)\ninitEventEmitter(Vir)\ninitSetter(Vir)\ninitGetter(Vir)\ninitSelector(Vir)\n\nexport default Vir","export const create = Object.create || function (target) {\n  let TEMP = function () {}\n  TEMP.prototype = target\n  let temp = new TEMP\n  TEMP.prototype = null\n  return temp\n}","import {\n  create\n} from '../lib/object'\n\nimport assign from '../lib/assign'\n\nexport default function (options = {}) {\n\n  let mixins = options.mixins || []\n\n\n  return assign.apply(null, [true, {\n    tagName: 'div',\n    data: create(null),\n    events: create(null),\n    methods: create(null),\n    watch: create(null),\n    validate: create(null),\n    beforeInit() {},\n    init() {},\n    inited() {}\n  }, options].concat(mixins))\n}","export default function (methods) {\n  Object.assign(this, methods)\n}","import {\n  isFunction\n} from '../lib/typeof'\n\nimport {\n  forEach\n} from '../lib/array'\n\nexport default function (events) {\n\n  function bindEvent(...args) {\n    let handler = args.pop()\n    if (isFunction(handler)) {\n      handler = [handler]\n    } else {\n      handler = handler.split(' ')\n    }\n\n    forEach(handler, (callback) => {\n      if (!isFunction(callback)) {\n        callback = this[callback]\n      }\n      this.$el.on.apply(this.$el, args.concat((event) => callback.call(this, event)))\n    })\n  }\n\n  for (let type in events) {\n    bindEvent.apply(this, type.split('->').concat(events[type]))\n  }\n}","import $ from 'jquery'\nimport {\n  create\n} from '../lib/object'\nimport initMixins from './mixins'\nimport initMethods from './methods'\nimport initWatch from './watch'\nimport initBindEvents from './bindEvents'\n\nlet uid = 0\n\nexport default function (Vir) {\n  Vir.prototype._init = function (options) {\n    let {\n      el,\n      tagName,\n      data, // object\n      events, // object\n      methods, // object\n      watch, // object\n      validate, // object\n      beforeInit,\n      init,\n      inited\n    } = initMixins(options)\n\n    this._uid = ++uid\n    this.$el = el ? $(el) : $('<' + tagName + '>')\n    this.data = data // state\n    this.validate = validate\n    this._events = create(null) // eventEmiter\n    this._cache = create(null) // selector cache (this.$$)\n\n    beforeInit.call(this)\n    initMethods.call(this, methods)\n    initWatch.call(this, watch)\n    initBindEvents.call(this, events)\n    init.call(this)\n    inited.call(this)\n  }\n}","import {\n  forEach,\n  indexOf\n} from './lib/array'\n\nexport default function (Vir) {\n\n  Vir.prototype.getEventListeners = function (type) {\n    if (type === void 0) {\n      return this._events\n    }\n    let t = type.toLowerCase()\n    return this._events[t] || (this._events[t] = [])\n  }\n\n  Vir.prototype.$watch = function (type, handler, once = false) {\n    handler._once = once\n    return this.on(type, handler)\n  }\n\n  Vir.prototype.on = function (type, handler) {\n    // todo 过滤重复绑定问题\n    this.getEventListeners(type).push(handler)\n    return () => {\n      this.off(type, handler)\n    }\n  }\n\n  Vir.prototype.once = function (type, handler) {\n    handler._once = true\n    this.on(type, handler)\n  }\n\n  Vir.prototype.off = function (type, handler) {\n    let queue = this.getEventListeners(type)\n    if (handler == void 0) {\n      queue.length = 0\n      return\n    }\n\n    let i = indexOf(queue, handler)\n\n    if (~i) {\n      queue.splice(i, 1)\n    }\n\n  }\n\n  Vir.prototype.emit = function (type, args, ctx) {\n    let queue = this.getEventListeners(type)\n    if (type != '*') {\n      queue = queue.concat(this.getEventListeners('*'))\n    }\n\n    forEach(queue, (handler) => {\n      handler.call(ctx, args)\n      if (handler._once) {\n        this.off(type, handler)\n      }\n    })\n\n  }\n}","import {\n  isObject,\n  isFunction\n} from './lib/typeof'\n\nexport default function (Vir) {\n  Vir.prototype.set = function (type, value, options = {}) {\n    if (isObject(type)) {\n      for (let i in type) {\n        this.set(i, type[i], value)\n      }\n    } else {\n\n      let old = this.get(type)\n\n      let args = {\n        old,\n        value,\n        type\n      }\n\n      let validate = this.validate[type]\n\n      if (isFunction(validate) && validate.call(this, args) !== void 0) {\n        return\n      }\n\n      this.data[type] = value\n\n      if (!options.force && old === value) {\n        return\n      }\n\n      if (options.silent) {\n        return\n      }\n\n      this.emit(type, args, this)\n    }\n  }\n}","export default function (Vir) {\n  Vir.prototype.get = function (name) {\n    return this.data[name]\n  }\n}","export default function (Vir) {\n  Vir.prototype.$$ = function (selector, cache) {\n\n    let _cache = this._cache\n\n    let _selector = selector.replace(/\\s/g, '')\n\n    if (cache === false) {\n      _cache[_selector] = null\n    }\n\n    let $el = _cache[_selector]\n    if ($el) {\n      return $el\n    }\n    $el = this.$el.find(selector)\n    _cache[_selector] = $el\n    return $el\n  }\n}"],"names":["type","val","toString","call","isArray","isObject","isFunction","isBoolean","assign","target","i","deep","source","key","_target","_source","forEach","array","callback","len","length","indexOf","value","Math","max","abs","handler","watch","name","on","Vir","options","this","_init","create","Object","TEMP","prototype","temp","mixins","apply","concat","methods","events","bindEvent","args","pop","split","_this","$el","event","uid","initMixins","el","tagName","data","validate","beforeInit","init","inited","_uid","$","_events","_cache","getEventListeners","t","toLowerCase","$watch","once","_once","push","off","queue","splice","emit","ctx","set","old","get","force","silent","$$","selector","cache","_selector","replace","find"],"mappings":"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"}